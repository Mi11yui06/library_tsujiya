<% @document_title = "資料目録詳細" %>
<div class="pb-2 border-bottom mb-3 d-flex justify-content-between align-items-start">
    <h1 class="h3">資料目録詳細画面</h1>
    <%= button_to '削除する', catalog_path(@catalog), method: :delete, onclick: "return confirm('本当に削除しますか？')" , class: "btn btn-sm btn-outline-danger"%>
</div>
<table class="table table-bordered border-dark">
    <tr>
        <th class="table-secondary" style="width: 20%">ISBN番号</th>
        <td><%= @catalog.isbn %></td>
    </tr>
    <tr>
        <th class="table-secondary">資料名</th>
        <td><%= @catalog.title %></td>
    </tr>
    <tr>
        <th class="table-secondary">分類</th>
        <td><%= @catalog.category.code %>: <%= @catalog.category.name %></td>
    </tr>
    <tr>
        <th class="table-secondary">著者</th>
        <td><%= @catalog.author %></td>
    </tr>
    <tr>
        <th class="table-secondary">出版社</th>
        <td><%= @catalog.publisher %></td>
    </tr>
    <tr>
        <th class="table-secondary">出版日</th>
        <td><%= @catalog.publish_date %></td>
    </tr>
    <tr>
        <th class="table-secondary">資料ID</th>
        <td><%= @catalog.stocks.pluck(:id).join(", ") %></td>
    </tr>
</table>
<p class="d-grid gap-2 d-md-block">
    <%= link_to '編集する', edit_catalog_path, method: :get, class: "btn btn-sm btn-outline-secondary me-2" %>
    <%= link_to '在庫を登録する', new_stock_path(catalog_id: @catalog.id), method: :get, class: "btn btn-sm btn-outline-success" %>
</p>
<p><%= link_to '一覧に戻る', catalogs_path %></p>

<h4>在庫一覧</h4>
<table class="table table-hover mt-3">
    <thead>
        <tr>
            <th>資料ID</th><th>ISBN番号</th><th>資料名</th><th>入荷年月日</th><th>廃棄年月日</th><th>備考</th><th>貸出状況</th>
        </tr>
    </thead>
    <tbody class="table-group-divider">
        <% @stocks.each do |s| %>
        <tr style="cursor: pointer;" onclick="window.location='<%= stock_path(s) %>';">
            <td><%= s.id %></td>
            <td><%= s.catalog.isbn %></td>
            <td><%= s.catalog.title %></td>
            <td><%= s.arrival_date %></td>
            <td><%= s.disposal_date %></td>
            <td><%= s.remarks %></td>
            <td>
                <% if s.discarded? %>
                -
                <% elsif s.currently_on_loan? %>
                貸出中
                <% else %>
                貸出可
                <% end %>
            </td>
        </tr>
        <% end %>
    </tbody>
</table>